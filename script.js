const modaInfantil = [
    {
        imagem: "produtos\\infantil\\infantil 0.jpg",
        nome: "Conjunto Infantil",
        preco: "25.00",
        preco_cartao: "27.00",
        descricao: "Algod√£o ",
        identificador: "MI001",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 1.jpg",
        imagem1: "produtos\\infantil\\infantil 1,1.jpg",
        nome: "Cueca Infantil",
        preco: "4.50",
        preco_cartao: "5.00",
        descricao: "personagem superman e homem aranha",
        identificador: "MI002",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 2.jpg",
        imagem1: "produtos\\infantil\\infantil 2,1.jpg",
        nome: "calcinha Infantil",
        preco: "4.50",
        preco_cartao: "5.00",
        descricao: "Algod√£o ",
        identificador: "MI003",
        tamanho: "P/M/G/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 3.jpg",
        imagem1: "produtos\\infantil\\infantil 3,1.jpg",
        nome: "Calcinha Infantil",
        preco: "6.50",
        preco_cartao: "7.00",
        descricao: "Algod√£o",
        identificador: "MI004",
        tamanho: "P/M/G/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 4.jpg",
        nome: "Vestido Infantil ",
        preco: "25.00",
        preco_cartao: "27.00",
        descricao: " N√£o garantimos a mesma estampa em todos os tamanhos.",
        identificador: "MI005",
        tamanho: "P/M/G",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 5.jpg",
        nome: "Vestido Infantil",
        preco: "25.00",
        preco_cartao: "27.00",
        descricao: "N√£o garantimos mesma estampa em todos os tamanhos.",
        identificador: "MI006",
        tamanho: "P/M/G",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 6.jpg",
        imagem1: "produtos\\infantil\\infantil 6,1.jpg",
        nome: "top infantil",
        preco: "8.50",
        preco_cartao: "9.00",
        descricao: "",
        identificador: "MI007",
        tamanho: "P/M/unico/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 7.jpg",
        nome: "Cueca Infantil",
        preco: "10.00",
        preco_cartao: "11.00",
        descricao: "",
        identificador: "MI008",
        tamanho: "P/M/unico/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 8.jpg",
        nome: "Kit Meia Infantil",
        preco: "8.00",
        preco_cartao: "9.00",
        descricao: "",
        identificador: "MI009",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 9.jpg",
        imagem1: "produtos\\infantil\\infantil 9,1.jpg",
        nome: "Kit Meia Infantil",
        preco: "16.50",
        preco_cartao: "18.00",
        descricao: "",
        identificador: "MI010",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 10.jpg",
        nome: "SHort Infantil",
        preco: "16.00",
        preco_cartao: "17.00",
        descricao: "1 a 8 anos",
        identificador: "MI011",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 11.jpg",
        imagem1: "produtos\\infantil\\infantil 11,1.jpg",
        imagem2: "produtos\\infantil\\infantil 11,2.jpg",
        imagem3: "produtos\\infantil\\infantil 11,3.jpg",
        imagem4: "produtos\\infantil\\infantil 11,4.jpg",
        imagem5: "produtos\\infantil\\infantil 11,5.jpg",
        imagem6: "produtos\\infantil\\infantil 11,6.jpg",
        imagem7: "produtos\\infantil\\infantil 11,7.jpg",
        imagem8: "produtos\\infantil\\infantil 11,8.jpg",
        imagem9: "produtos\\infantil\\infantil 11,9.jpg",
        nome: "Vestido Infantil",
        preco: "25.00",
        preco_cartao: "27.00",
        descricao: "",
        identificador: "MI012",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 12.jpg",
        nome: "Bermuda Infantil",
        preco: "40.00",
        preco_cartao: "42.00",
        descricao: "",
        identificador: "MI013",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 13.jpg",
        imagem1: "produtos\\infantil\\infantil 13,1.jpg",
        imagem2: "produtos\\infantil\\infantil 13,2.jpg",
        nome: "Kit Calcinha Diamante (Infantil) ",
        preco: "130.00",
        preco_cartao: "120",
        descricao: "kit com 7 pe√ßas",
        identificador: "MI014",
        tamanho: "P/M/G/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 14.jpg",
        imagem1: "produtos\\infantil\\infantil 14,1.jpg",
        imagem2: "produtos\\infantil\\infantil 14,2.jpg",
        imagem3: "produtos\\infantil\\infantil 14,3.jpg",
        imagem4: "produtos\\infantil\\infantil 14,4.jpg",
        imagem5: "produtos\\infantil\\infantil 14,5.jpg",
        nome: "Baby Doll Infantil",
        preco: "25.00",
        preco_cartao: "27.00",
        descricao: "N√£o tem no atacado",
        identificador: "MI015",
        tamanho: "P/M/G/GG/EX",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 15.jpg",
        imagem1: "produtos\\infantil\\infantil 15,1.jpg",
        nome: "Conjunto Juvenil",
        preco: "16.00",
        preco_cartao: "17.00",
        descricao: "",
        identificador: "MI016",
        tamanho: "P/M/unico/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 16.jpg",
        imagem1: "produtos\\infantil\\infantil 16,1.jpg",
        imagem2: "produtos\\infantil\\infantil 16,2.jpg",
        imagem3: "produtos\\infantil\\infantil 16,3.jpg",
        imagem4: "produtos\\infantil\\infantil 16,4.jpg",
        imagem5: "produtos\\infantil\\infantil 16,5.jpg",
        nome: "Kit Cueca Diamante",
        preco: "164.00",
        preco_cartao: "176.00",
        descricao: "Kit com 4 pe√ßas personalizadas Infantil",
        identificador: "MI017",
        tamanho: "P/M/G/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 17.jpg",
        nome: "Cueca Infantil",
        preco: "10.00",
        preco_cartao: "11.00",
        descricao: "Tecido algod√£o",
        identificador: "MI018",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 18.jpg",
        nome: "Camisa Infantil",
        preco: "20.00",
        preco_cartao: "24.00",
        descricao: "Tecido algod√£o;",
        identificador: "MI019",
        tamanho: "11 ano/2 anos/3 anos/4 anos/5 anos/6 anos/7 anos/8 anos/9 anos/10 anos/12 anos/14 anos/16",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 19.jpg",
        nome: "Toalha Infantil",
        preco: "26.00",
        preco_cartao: "28.00",
        descricao: "Tecido algod√£o",
        identificador: "MI020",
        tamanho: "tamanho 1,30x70cm",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 20.jpg",
        nome: "Calcinha Infantil",
        preco: "6.50",
        preco_cartao: "7.50",
        descricao: "",
        identificador: "MI021",
        tamanho: "P/M/unico/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 21.jpg",
        nome: "Cueca Lupo Infantil",
        preco: "23.00",
        preco_cartao: "25.00",
        descricao: "",
        identificador: "MI022",
        tamanho: "PP/PunicoM/G/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 22.jpg",
        nome: "Calcinha Box Infantil",
        preco: "5.50",
        preco_cartao: "6.00",
        descricao: "",
        identificador: "MI023",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 23.jpg",
        imagem1: "produtos\\infantil\\infantil 23,1.jpg",
        imagem2: "produtos\\infantil\\infantil 23,2.jpg",
        imagem3: "produtos\\infantil\\infantil 23,3.jpg",
        imagem4: "produtos\\infantil\\infantil 23,4.jpg",
        imagem5: "produtos\\infantil\\infantil 23,5.jpg",
        imagem6: "produtos\\infantil\\infantil 23,6.jpg",
        imagem7: "produtos\\infantil\\infantil 23,7.jpg",
        imagem8: "produtos\\infantil\\infantil 23,8.jpg",
        nome: "Baby Doll Infantil",
        preco: "16.50",
        preco_cartao: "19.00",
        descricao: "",
        identificador: "MI024",
        tamanho: "P/M/unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 24.jpg",
        nome: "Calcinha Infantil",
        preco: "6.50",
        preco_cartao: "7.00",
        descricao: "",
        identificador: "MI025",
        tamanho: "P/M/unico/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 25.jpg",
        nome: "Calcinha Infantil",
        preco: "7.50",
        preco_cartao: "8.00",
        descricao: "Tecido algod√£o",
        identificador: "MI026",
        tamanho: "P/M/G/GG",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 26.jpg",
        nome: "Kit Calcinha Diamante",
        preco: "164.00",
        preco_cartao: "176.00",
        descricao: "Kit com 7",
        identificador: "MI027",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 27.jpg",
        nome: "Rede ber√ßo",
        preco: "130.00",
        preco_cartao: "160.00",
        descricao: "",
        identificador: "MI028",
        tamanho: "unico",
        categoria: "Infantil"
    },
    {
        imagem: "produtos\\infantil\\infantil 28.jpg",
        imagem1: "produtos\\infantil\\infantil 28,1.jpg",
        nome: "Kit Cueca Diamante",
        preco: "164.00",
        preco_cartao: "176.00",
        descricao: "Tecido algod√£o; kit com 4 pe√ßas personalizadas infantil",
        identificador: "MI029",
        tamanho: "unico",
        categoria: "Infantil"
    },
];
const modaCalcinha = [
    {
        imagem: "produtos/Calcinha/calcinha 0.jpg",
        nome: "Calcinha Fio Duplo",
        preco: "9.50",
        preco_cartao: "12.50",
        descricao: "Valor Promocional ",
        identificador: "MC001",
        tamanho: "P/M/G/GG",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 1.jpg",
        nome: "Calcinha Box",
        preco: "11.00",
        preco_cartao: "12.50",
        descricao: "",
        identificador: "MC002",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 2.jpg",
        nome: "Calcinha Renda",
        preco: "13.00",
        preco_cartao: "15.00",
        descricao: "",
        identificador: "MC003",
        tamanho: "P/M/G/GG",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 3.jpg",
        nome: "Calcinha Variadas",
        preco: "6.00",
        preco_cartao: "6.50",
        descricao: "Valor Promocional ",
        identificador: "MC004",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 4.jpg",
        nome: "Calcinha sem Costura",
        preco: "8.35",
        preco_cartao: "9.00",
        descricao: "",
        identificador: "MC005",
        tamanho: "unico",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 5.jpg",
        nome: "Calcinha Cinta",
        preco: "23.00",
        preco_cartao: "26.00",
        descricao: "",
        identificador: "MC006",
        tamanho: "P/M/G/GG",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 6.jpg",
        nome: "Kit Calcinha Diamante",
        preco: "110.00",
        preco_cartao: "120.00",
        descricao: "algod√£o",
        identificador: "MC007",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 7.jpg",
        imagem1: "produtos/Calcinha/calcinha 7,1.jpg",
        nome: "Kit calcinha diamante",
        preco: "130.00",
        preco_cartao: "139.00",
        descricao: " kit com 3 Calcinhas Tamanho",
        identificador: "MC008",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 8.jpg",
        imagem1: "produtos/Calcinha/calcinha 8,1.jpg",
        nome: "Calcinha Algod√£o",
        preco: "17.00",
        preco_cartao: "18.00",
        descricao: "R$ 18,00",
        identificador: "MC009",
        tamanho: "P/M/G/",
        tamanhoextra: "GG",
        precoextra: "19.00",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 9.jpg",
        imagem1: "produtos/Calcinha/calcinha 9,1.jpg",
        nome: "Calcinha com Frases",
        preco: "20.00",
        preco_cartao: "22.50",
        descricao: "",
        identificador: "MC010",
        tamanho: "unico",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 10.jpg",
        imagem1: "produtos/Calcinha/calcinha 10,1.jpg",
        nome: "Kit de Calcinha Diamantes",
        preco: "105.00",
        preco_cartao: "112.00",
        descricao: "kit com 3 Calcinhas",
        identificador: "MC011",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 11.jpg",
        nome: "Kit Calcinha Diamante",
        preco: "130.00",
        preco_cartao: "137.00",
        descricao: "kit com 5 pe√ßas",
        identificador: "MC012",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 12.jpg",
        imagem1: "produtos/Calcinha/calcinha 12,1.jpg",
        nome: "Kit Calcinha Diamante",
        preco: "132.00",
        preco_cartao: "140.00",
        descricao: "Kit com 4 pe√ßas",
        identificador: "MC013",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 13.jpg",
        nome: "Calcinha Fio Duplo",
        preco: "11.00",
        preco_cartao: "12.50",
        descricao: "",
        identificador: "MC014",
        tamanho: "P/M/G/GG",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 14.jpg",
        nome: "Calcinha Tailandesa",
        preco: "11.00",
        preco_cartao: "12.50",
        descricao: "",
        identificador: "MC015",
        tamanho: "Unico",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 15.jpg",
        nome: "Calcinha Variada",
        preco: "6.00",
        preco_cartao: "6.50",
        descricao: "",
        identificador: "MC016",
        tamanho: 'unico',
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 16.jpg",
        nome: "Calcinha com Nome",
        preco: "20.00",
        preco_cartao: "22.50",
        descricao: "",
        identificador: "MC017",
        tamanho: "unico",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 17.jpg",
        nome: "Calcinha com frases",
        preco: "8.50",
        preco_cartao: "9.00",
        descricao: "",
        identificador: "MC018",
        tamanho: "unico",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 18.jpg",
        nome: "Calcinha Corpo Colado",
        preco: "17.50",
        preco_cartao: "19.50",
        descricao: "Algod√£o com C√≥s",
        identificador: "MC019",
        tamanho: "unico",
        categoria: "Calcinha",
    },
    {
        imagem: "produtos/Calcinha/calcinha 19.jpg",
        nome: "Kit Calcinha Diamante",
        preco: "118.00",
        preco_cartao: "127.00",
        descricao: "algod√£o",
        identificador: "MC020",
        tamanho: "P/M/G",
        categoria: "Calcinha",
    },
]

const seccaoDetalhes = document.querySelector(".seccao_especifica");

function renderizarProdutos(categoriaId, produtos) {
    const secao = document.querySelector(`#${categoriaId}`);
    const container = secao.querySelector(".produtos");

    if (container.children.length > 0) return;

    container.innerHTML = "";

    const containerGeral = secao.querySelector(".container");

    produtos.forEach(prod => {
        const divProduto = criarElementoProduto(prod);
        divProduto.addEventListener("click", () => exibirDetalhesProduto(prod, containerGeral));
        container.appendChild(divProduto);
    });
}

function criarElementoProduto(prod) {
    const divProduto = document.createElement("div");
    divProduto.classList.add("produto");

    divProduto.innerHTML = `
        <img class="imagem" src="${prod.imagem}" alt="${prod.nome}">
        <h3 class="nome_produto">${prod.nome}</h3>
        <button class="preco">R$ ${prod.preco}</button>
        <p class="descricao">${prod.descricao}</p>
    `;

    return divProduto;
}

function exibirDetalhesProduto(prod, containerGeral) {
    document.querySelectorAll("section").forEach(section => section.style.display = "none");
    containerGeral.style.display = "none";
    seccaoDetalhes.style.display = "grid";

    const imagensExtras = [prod.imagem];
    for (let i = 1; i <= 8; i++) {
        const key = `imagem${i}`;
        if (prod[key]) imagensExtras.push(prod[key]);
    }

    seccaoDetalhes.innerHTML = gerarHTMLDetalhes(prod, imagensExtras);
    configurarEventosDetalhes(prod, containerGeral);
}

function gerarHTMLDetalhes(prod, imagens) {
    const tamanhos = prod.tamanho ? prod.tamanho.split('/').filter(t => t) : [];
    let opcoesTamanhoHTML = `<option value="">Selecione</option>`;

    tamanhos.forEach(tamanho => {
        opcoesTamanhoHTML += `<option value="${tamanho}">${tamanho}</option>`;
    });

    // Se existir tamanhoextra, adiciona uma op√ß√£o extra
    if (prod.tamanhoextra) {
        // Para valor do option, guardar s√≥ o texto mesmo
        opcoesTamanhoHTML += `<option value="${prod.tamanhoextra}">${prod.tamanhoextra}</option>`;
    }
    return `
        <div class="detalhes-produto">
            <button class="fechar-detalhes"><i class="bi bi-x-circle"></i></button>
            <h3>${prod.nome}</h3>
            <div class="detalhes">
                <img class="principal" src="${prod.imagem}" alt="${prod.nome}">
                <div class="informacoes">
                    <p><strong>Pre√ßo √† vista:</strong> R$ ${prod.preco}</p>
                    <p><strong>Pre√ßo no cart√£o:</strong> R$ ${prod.preco_cartao}</p>
                    <p><strong>Descri√ß√£o: </strong>${prod.descricao}</p>
                    <div class="tamanho-select">
                        <label for="tamanho"><strong>Tamanho:</strong></label>
                        <select id="tamanho" class="selecionar-tamanho">
                            ${opcoesTamanhoHTML}
                        </select>
                    </div>
                    <button class="adicionar-carrinho">Adicionar ao Carrinho</button>
                </div>
            </div>
            <div class="galeria">
                ${imagens.map(src => `<img src="${src}" alt="${prod.nome}">`).join("")}
            </div>
        </div>
    `;
}

function configurarEventosDetalhes(prod, containerGeral) {
    const imgPrincipal = seccaoDetalhes.querySelector(".principal");
    const selectTamanho = seccaoDetalhes.querySelector(".selecionar-tamanho");
    const precoVistaSpan = seccaoDetalhes.querySelector("#preco-vista");
    const subtotalSpan = seccaoDetalhes.querySelector("#subtotal");

    seccaoDetalhes.querySelectorAll(".galeria img").forEach(mini => {
        mini.addEventListener("click", () => {
            imgPrincipal.src = mini.src;
        });
    });

    seccaoDetalhes.querySelector(".fechar-detalhes").addEventListener("click", () => {
        seccaoDetalhes.style.display = "none";
        containerGeral.style.display = "grid";

        document.querySelectorAll("section").forEach(section => {
            section.style.display = "grid";
        });

        resetarLayoutProdutos();
    });

    // Atualiza pre√ßo quando muda tamanho
    selectTamanho.addEventListener("change", () => {
        const selecionado = selectTamanho.value;
        let precoAtual = parseFloat(prod.preco);

        if (selecionado === prod.tamanhoextra) {
            precoAtual = parseFloat(prod.precoextra);
        }

        precoVistaSpan.textContent = precoAtual.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        subtotalSpan.textContent = precoAtual.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    });

    seccaoDetalhes.querySelector(".adicionar-carrinho").addEventListener("click", () => {
        const tamanhoSelecionado = selectTamanho.value;

        if (!tamanhoSelecionado) {
            mostrarAlertaCustomizado("Por favor, selecione um tamanho!");
            return;
        }


        const precoSelecionado = tamanhoSelecionado === prod.tamanhoextra && prod.precoextra ? prod.precoextra : prod.preco;

        const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

        const produtoCarrinho = {
            identificador: `${prod.identificador}_${tamanhoSelecionado}`,
            nome: prod.nome,
            preco: precoSelecionado, // Use o pre√ßo correto aqui
            preco_cartao: prod.preco_cartao,
            imagem: prod.imagem,
            descricao: prod.descricao,
            categoria: prod.categoria,
            tamanho: tamanhoSelecionado,
            quantidade: 1
        };

        carrinho.push(produtoCarrinho);
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        mostrarAlertaCustomizado("Produto adicionado ao carrinho!");
    });
}

function resetarLayoutProdutos() {
    document.querySelectorAll("section .produtos").forEach(container => {
        container.style.removeProperty("display");
        container.style.transition = "all 0.3s ease";
    });


    document.querySelectorAll("section").forEach(secao => {
        secao.style.display = "";
    });
}

// Carrinho
document.getElementById("carrinho").addEventListener("click", () => {
    carregarCarrinho();
    console.log(JSON.parse(localStorage.getItem("carrinho")));
    document.getElementById("sessao-carrinho").style.display = "flex";
    document.getElementById("sessao-frete").style.display = "none";
    seccaoDetalhes.style.display = "none";
    // Garante que o header apare√ßa
    document.querySelector("header").style.display = "flex";

    const esconder = [
        "nav",
        ".botoes-laterais",
        ".redes-sociais",
        ".banner",
        "#moda-infantil",
        "#moda-calcinha",
    ];
    esconder.forEach(sel => {
        document.querySelectorAll(sel).forEach(el => el.style.display = "none");
    });
});


function fecharCarrinho() {
    const resetar = [
        { selector: "nav", display: "flex" },
        { selector: ".botoes-laterais", display: "flex" },
        { selector: ".redes-sociais", display: "flex" },
        { selector: ".banner", display: "grid" },
        { selector: "#sessao-frete", display: "block" },
        { selector: "#moda-infantil", display: "grid" },
        { selector: "#moda-calcinha", display: "grid" },
    ];

    resetar.forEach(item => {
        document.querySelectorAll(item.selector).forEach(el => {
            el.style.display = item.display; // Define o display espec√≠fico
        });
    });

    // Ocultar a se√ß√£o do carrinho
    document.getElementById("sessao-carrinho").style.display = "none";
}

function carregarCarrinho() {
    const container = document.getElementById("lista-carrinho");
    container.innerHTML = "";

    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    carrinho.forEach((prod, index) => container.appendChild(criarItemCarrinho(prod, index, carrinho)));

    atualizarResumoCompra(carrinho);
}
function calcularFretePorBairro(bairro) {
    const bairrosFrete10 = [
        "Alemanha", "Alto do Angelim", "Alto do Calhau", "Alto do Pinho", "Alto Tur√∫", "Anil",
        "Angelim", "Apeadouro", "Aroeiras", "Areinha", "Aurora", "Bairro de F√°tima", "Barramar",
        "Barreto", "Belira", "Bequim√£o", "Calhau", "Camboa", "Cantinho do C√©u", "Caratatiua",
        "Centro", "Ch√°cara Brasil", "Codozinho", "Cohab", "Cohafuma", "Cohajap", "Cohama",
        "Cohapam", "Cohaserma", "Cohatrac", "Coheb", "Coreia de Baixo", "Coreia de Cima",
        "Coroado", "Cruzeiro do Anil", "Cutim Anil", "Diamante", "Divin√©ia", "Fabril", "F√© em Deus",
        "Filipinho", "Forquilha", "Grand Park", "Ilhinha", "Ipase de Baixo", "Ipase de Cima",
        "Ipem Tur√∫", "Itapirac√≥", "Ivar Saldanha", "Jaracaty", "Jardim Alvorada", "Jardim das Margaridas",
        "Jardim Eldorado", "Jardim Turu", "Jo√£o de Deus", "Jo√£o Paulo", "Jordoa", "Liberdade",
        "Lira", "Maca√∫ba", "Madre Deus", "Maiobinha", "Maranh√£o Novo", "Monte Castelo", "Novo Angelim",
        "Olho d'√Ågua", "Outeiro da Cruz", "P√£o de A√ß√∫car", "Parque Amazonas", "Parque Athenas",
        "Parque Atl√¢ntico", "Parque dos Sabi√°s", "Parque Shalom", "Parque Universit√°rio", "Parque Vit√≥ria",
        "Pen√≠nsula", "Pirapora", "Planalto Anil", "Planalto Ping√£o", "Ponta d'Areia", "Ponta do Farol",
        "Quintas do Calhau", "Quitandinha", "Recanto Fialho", "Recanto Tur√∫", "Recanto Vinhais",
        "Reden√ß√£o", "Renascen√ßa", "Residencial Araras", "Residencial S√£o Domingos", "Rio Anil",
        "Sacav√©m", "Salina do Sacav√©m", "Santa Cruz", "Santa Rosa", "Santo Ant√¥nio", "S√£o Bernardo",
        "S√£o Crist√≥v√£o", "S√£o Francisco", "Saramanta", "Solar dos Lusitanos", "Sol e Mar",
        "Terra Livre", "Tirirical", "T√∫nel do Sacav√©m", "Vera Cruz", "Vila 7 de Setembro",
        "Vila Bessa", "Vila Brasil", "Vila Concei√ß√£o (Alto do Calhau)", "Vila Cruzado",
        "Vila Isabel Cafeteira (Cohab)", "Vila Lob√£o", "Vila Luiz√£o", "Vila Palmeira", "Vila Passos",
        "Vila Vicente Fialho", "Vinhais"
    ];
    const bairrosFrete12 = [
        "Alemanha", "Alto do Angelim", "Alto do Calhau", "Alto do Pinho", "Angelim", "Anil",
        "Apeadouro", "Areinha", "Aurora", "Bairro de F√°tima", "Barramar", "Barreto", "Belira",
        "Bequim√£o", "Calhau", "Camboa", "Cantinho do C√©u", "Caratatiua", "Centro", "Ch√°cara Brasil",
        "Codozinho", "Cohab", "Cohafuma", "Cohajap", "Cohama", "Cohapam", "Cohaserma", "Cohatrac",
        "Coreia de Baixo", "Coreia de Cima", "Coroado", "Coheb", "Cruzeiro do Anil", "Cutim Anil",
        "Diamante", "F√© em Deus", "Fabril", "Filipinho", "Forquilha", "Grand Park", "Ilhinha",
        "Ipase de Baixo", "Ipase de Cima", "Ipem Tur√∫", "Itapirac√≥", "Ivar Saldanha", "Jaracaty",
        "Jardim Alvorada", "Jardim das Margaridas", "Jardim Eldorado", "Jo√£o de Deus", "Jo√£o Paulo",
        "Jordoa", "Liberdade", "Lira", "Maca√∫ba", "Madre Deus", "Maranh√£o Novo", "Mat√µes Tur√∫",
        "Monte Castelo", "Novo Angelim", "Olho d'√Ågua", "Outeiro da Cruz", "P√£o de A√ß√∫car",
        "Parque Amazonas", "Parque Athenas", "Parque Atl√¢ntico", "Parque dos Sabi√°s", "Parque Shalom",
        "Parque Universit√°rio", "Pen√≠nsula", "Planalto Anil", "Planalto Ping√£o", "Ponta d'Areia",
        "Ponta do Farol", "Quintas do Calhau", "Quitandinha", "Recanto dos Nobres", "Recanto Fialho",
        "Recanto Vinhais", "Reden√ß√£o", "Renascen√ßa", "Residencial Araras", "Residencial S√£o Domingos",
        "Rio Anil", "S√£o Crist√≥v√£o", "S√£o Francisco", "Saramanta", "Sacav√©m", "Salina do Sacav√©m",
        "Santa Cruz", "Santo Ant√¥nio", "S√£o Bernardo", "Solar dos Lusitanos", "T√∫nel do Sacav√©m",
        "Tirirical", "Vera Cruz", "Vila 7 de Setembro", "Vila Bessa", "Vila Brasil", "Vila Cruzado",
        "Vila Concei√ß√£o (Alto do Calhau)", "Vila Isabel Cafeteira (Cohab)", "Vila Lob√£o", "Vila Passos",
        "Vila Palmeira", "Vila Vicente Fialho", "Vinhais"
    ];

    if (!bairro || bairro.trim() === "") return 0; // frete gr√°tis se n√£o tiver bairro

    bairro = bairro.trim();

    if (bairrosFrete10.includes(bairro)) {
        return 10;
    } else if (bairrosFrete12.includes(bairro)) {
        return 12;
    } else {
        return 15; // frete  para bairros que n√£o est√£o nas listas
    }
}

function criarItemCarrinho(prod, index, carrinho) {
    const item = document.createElement("div");
    item.classList.add("item-carrinho");

    const precoUnitario = parseFloat(prod.preco); // Use prod.preco aqui
    const subtotal = precoUnitario * prod.quantidade;

    item.innerHTML = `
    <img src="${prod.imagem}" alt="${prod.nome}" class="imagem-carrinho">  
    <div>
        <h3>${prod.nome}</h3>
        <p><strong>Pre√ßo unit√°rio:</strong> R$ ${precoUnitario.toFixed(2)}</p>
        <p><strong>Subtotal:</strong> R$ ${subtotal.toFixed(2)}</p>
        <p><strong>Tamanho:</strong> ${prod.tamanho}</p>
    </div>
    <div class="controle-quantidade">
        <button class="btn-menos">-</button>
        <span class="quantidade">${prod.quantidade}</span>
        <button class="btn-mais">+</button>
    </div>
`;

    // Adiciona eventos para controle de quantidade
    item.querySelector(".btn-menos").addEventListener("click", () => {
        if (prod.quantidade > 1) {
            carrinho[index].quantidade--;
        } else {
            carrinho.splice(index, 1);
        }
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        carregarCarrinho();
    });

    item.querySelector(".btn-mais").addEventListener("click", () => {
        carrinho[index].quantidade++;
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        carregarCarrinho();
    });

    return item;
}   

function criarResumoCompra() {
    let containerResumo = document.getElementById("container-resumo");
    if (!containerResumo) {
        containerResumo = document.createElement("div");
        containerResumo.id = "container-resumo";
        document.getElementById("sessao-carrinho").appendChild(containerResumo);
    }

    let sessaoFrete = document.getElementById("sessao-frete");
    if (!sessaoFrete) {
        sessaoFrete = document.createElement("section");
        sessaoFrete.id = "sessao-frete";
        sessaoFrete.innerHTML = `
        <h2 class="titulo-endereco">Endere√ßo de Entrega</h2>
        
                <div class="campo-endereco">
                    <label for="cep">CEP:</label>
                    <input type="text" id="cep" maxlength="9" placeholder="65000-000" class="input-endereco">
                </div>

                <div class="campo-endereco">
                    <label for="rua">Rua:</label>
                    <input type="text" id="rua" readonly class="input-endereco">
                </div>

                <div class="campo-endereco">
                    <label for="bairro">Bairro:</label>
                    <input type="text" id="bairro" readonly class="input-endereco">
                    </div>
                    
                <div class="campo-endereco">
                    <label for="numero">N√∫mero:</label>
                    <input type="text" id="numero" class="input-endereco">
                </div>

                <div class="campo-endereco">
                    <label for="complemento">Complemento:</label>
                    <input type="text" id="complemento" class="input-endereco">
                </div>
                <button class="fechar-frete">confirmar</i></button>
            `;
        containerResumo.appendChild(sessaoFrete);
        const botaoFechar = sessaoFrete.querySelector(".fechar-frete");
        botaoFechar.addEventListener("click", () => {
            sessaoFrete.style.display = "none";

            // Mostrar novamente o conte√∫do do carrinho e o resumo
            const conteudoCarrinho = document.getElementById("conteudo-carrinho");
            const resumo = document.getElementById("resumo-compra");

            if (conteudoCarrinho) conteudoCarrinho.style.display = "block";
            if (resumo) resumo.style.display = "block";
        });



        // ViaCEP l√≥gica
        const cepInput = document.getElementById("cep");
        const ruaInput = document.getElementById("rua");
        const bairroInput = document.getElementById("bairro");

        cepInput.addEventListener("blur", () => {
            const cep = cepInput.value.replace(/\D/g, "");
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(res => res.json())
                    .then(data => {
                        if (!data.erro) {
                            ruaInput.value = data.logradouro;
                            bairroInput.value = data.bairro;
                            carregarCarrinho(); // Atualiza o resumo quando o bairro mudar
                        } else {
                            alert("CEP n√£o encontrado.");
                            ruaInput.value = "";
                            bairroInput.value = "";
                            carregarCarrinho();
                        }
                    })
                    .catch(() => {
                        alert("Erro ao buscar o CEP.");
                    });
            } else {
                ruaInput.value = "";
                bairroInput.value = "";
                carregarCarrinho();
            }
        });

        // Atualiza o resumo ao mudar o bairro manualmente (caso permita edi√ß√£o)
        bairroInput.addEventListener("input", () => {
            carregarCarrinho();
        });
    }

    let resumo = document.getElementById("resumo-compra");
    if (!resumo) {
        resumo = document.createElement("div");
        resumo.id = "resumo-compra";
        resumo.innerHTML = `
            <h2>Resumo da compra</h2>
            <div class="linha linhaProdutos">
                <span class="titulo">Produtos (0):</span>
                <span class="valor" id="total-produtos">0,00</span>
            </div>
            <div class="linha fretes">
                <span class="titulo">Frete:</span>
                <span class="valor" id="valor-frete">Gr√°tis</span>
                <button id="botao-escolher-endereco">escolha seu endere√ßo</button>
            </div>
            <div class="linha total">
                <span class="titulo">Total:</span>
                <span class="valor" id="valor-total">0,00</span>
            </div>
            <button id="botao-continuar-compra">Continuar a compra</button>
        `;
        containerResumo.appendChild(resumo);
    }

    const botaoMostrarFrete = document.getElementById("botao-escolher-endereco");
    if (botaoMostrarFrete) {
        botaoMostrarFrete.addEventListener("click", () => {
            if (sessaoFrete) {
                sessaoFrete.style.display = "flex";
            }
            if (conteudoCarrinho) {
                conteudoCarrinho.style.display = "none";
            }
            if (resumo) {
                resumo.style.display = "none";
            }
        });
    }

    return resumo;
}

function atualizarResumoCompra(carrinho) {
    const resumo = criarResumoCompra();
    const formatarValor = valor => valor.toFixed(2).replace(".", ",");

    const quantidadeProdutos = carrinho.reduce((acc, prod) => acc + prod.quantidade, 0);
    const totalProdutos = carrinho.reduce((acc, prod) => acc + parseFloat(prod.preco) * prod.quantidade, 0);

    // Pega o bairro para calcular frete
    const bairroInput = document.getElementById("bairro");
    const bairro = bairroInput ? bairroInput.value : "";
    const frete = calcularFretePorBairro(bairro);

    const totalGeral = totalProdutos + frete;

    resumo.querySelector(".linhaProdutos .titulo").textContent = `Produtos: (${quantidadeProdutos})`;
    resumo.querySelector("#total-produtos").textContent = `R$ ${formatarValor(totalProdutos)}`;
    resumo.querySelector(".fretes .valor").textContent = frete === 0 ? "Gr√°tis" : `R$ ${formatarValor(frete)}`;
    resumo.querySelector(".total .valor").textContent = `R$ ${formatarValor(totalGeral)}`;
}

function carregarCarrinho() {
    const container = document.getElementById("lista-carrinho");
    container.innerHTML = "";

    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

    if (carrinho.length === 0) {
        container.innerHTML = "<p style='font-size:1.5rem;'>Seu carrinho est√° vazio üòï</p>";
        atualizarResumoCompra(carrinho);
        return;
    }

    carrinho.forEach((prod, index) => {
        container.appendChild(criarItemCarrinho(prod, index, carrinho));
    });

    atualizarResumoCompra(carrinho);
}

function mostrarsessaofrete() {
    const sessaoFrete = document.getElementById("sessao-frete");
    const carrinho = document.getElementById("conteudo-carrinho");
    const resumo = document.getElementById("resumo-compra");

    if (sessaoFrete && carrinho && resumo) {
        sessaoFrete.style.display = "block";
        carrinho.style.display = "none";
        resumo.style.display = "none";
    }
}
function mostrarAlertaCustomizado(texto) {
    const alerta = document.getElementById("alerta-customizado");
    const mensagem = document.getElementById("mensagem-alerta");

    mensagem.textContent = texto || "Produto adicionado ao carrinho!";
    alerta.classList.add("mostrar");

    setTimeout(() => {
        alerta.classList.remove("mostrar");
    }, 3000);
}

window.addEventListener("DOMContentLoaded", () => {
    renderizarProdutos("moda-infantil", modaInfantil);
    renderizarProdutos("moda-calcinha", modaCalcinha);
    resetarLayoutProdutos();
});
