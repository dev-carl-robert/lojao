const modaLupo = [
    {
        imagem: "produtos/lupo/lupo0.jpg",
        imagem1: "produtos/lupo/lupo0,1.jpg",
        nome: "Leg Max Lupo",
        preco: "135.00",
        preco_cartao: "150.00",
        descricao: "",
        identificador: "ml001",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo1.jpg",
        imagem1: "produtos/lupo/lupo1,1.jpg",
        imagem2: "produtos/lupo/lupo1,2.jpg",
        nome: "Leg Seamless Basic Lupo",
        preco: "132.00",
        preco_cartao: "146.00",
        descricao: "",
        identificador: "ml002",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo2.jpg",
        imagem1: "produtos/lupo/lupo2,1.jpg",
        nome: "Leg Act Seamless Lupo",
        preco: "137.00",
        preco_cartao: "145.00",
        descricao: "",
        identificador: "ml003",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo3.jpg",
        imagem1: "produtos/lupo/lupo3,1.jpg",
        imagem3: "produtos/lupo/lupo3,2.jpg",
        nome: "Basic Fit Lupo",
        preco: "146.00",
        preco_cartao: "162.00",
        descricao: "",
        identificador: "ml004",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo4.jpg",
        imagem1: "produtos/lupo/lupo4,1.jpg",
        nome: "Capri Lupo",
        preco: "125.00",
        preco_cartao: "135.00",
        descricao: "",
        identificador: "ml005",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo5.jpg",
        imagem1: "produtos/lupo/lupo5,1.jpg",
        nome: "Short Basic Lupo",
        preco: "77.00",
        preco_cartao: "86.00",
        descricao: "",
        identificador: "ml006",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo6.jpg",
        imagem1: "produtos/lupo/lupo6,1.jpg",
        nome: "Bermuda Max Lupo",
        preco: "76.00",
        preco_cartao: "85.00",
        descricao: "",
        identificador: "ml007",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo7.jpg",
        imagem1: "produtos/lupo/lupo7,1.jpg",
        nome: "Short Atack Lupo",
        preco: "72.00",
        preco_cartao: "80.00",
        descricao: "",
        identificador: "ml008",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo8.jpg",
        imagem1: "produtos/lupo/lupo8,1.jpg",
        nome: "Bermuda Basic Fit Lupo",
        preco: "87.00",
        preco_cartao: "95.00",
        descricao: "",
        identificador: "ml009",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo9.jpg",
        imagem1: "produtos/lupo/lupo9,1.jpg",
        nome: "Top Atack Lupo",
        preco: "72.00",
        preco_cartao: "80.00",
        descricao: "",
        identificador: "ml010",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo10.jpg",
        imagem1: "produtos/lupo/lupo10,1.jpg",
        nome: "Top Canelado Lupo",
        preco: "72.00",
        preco_cartao: "80.00",
        descricao: "",
        identificador: "ml011",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo11.jpg",
        imagem1: "produtos/lupo/lupo11,1.jpg",
        nome: "Top Basic Lupo",
        preco: "83.00",
        preco_cartao: "86.00",
        descricao: "",
        identificador: "ml012",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo12.jpg",
        imagem1: "produtos/lupo/lupo12,1.jpg",
        imagem1: "produtos/lupo/lupo12,1.jpg",
        nome: "Meia Curta Adulto Walk Lupo",
        preco: "10.50",
        preco_cartao: "11.75",
        descricao: "Par",
        identificador: "ml013",
        tamanho: "unico",
    },
    {
        imagem: "produtos/lupo/lupo13.jpg",
        imagem1: "produtos/lupo/lupo13,1.jpg",
        imagem1: "produtos/lupo/lupo13,2.jpg",
        nome: "Meia Lupo AF Sap. Anti Lupo",
        preco: "32.00",
        preco_cartao: "35.00",
        descricao: "Par",
        identificador: "ml014",
        tamanho: "unico",
    },
    {
        imagem: "produtos/lupo/lupo14.jpg",
        nome: "Camisa Térmica Feminino Lupo",
        preco: "127.00",
        preco_cartao: "141.00",
        descricao: "",
        identificador: "ml015",
        tamanho: "M/G/GG",
    },
        {
        imagem: "produtos/lupo/lupo15.jpg",
        imagem1: "produtos/lupo/lupo15,1.jpg",
        nome: "Camisa Térmica Masculino Lupo",
        preco: "130.00",
        preco_cartao: "146.00",
        descricao: "",
        identificador: "ml016",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo16.jpg",
        imagem1: "produtos/lupo/lupo16,1.jpg",
        nome: "Bermuda Térmica Masculino Lupo",
        preco: "82.00",
        preco_cartao: "90.00",
        descricao: "",
        identificador: "ml017",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo17.jpg",
        imagem1: "produtos/lupo/lupo17,1.jpg",
        nome: "Macacão Lupo",
        preco: "205.00",
        preco_cartao: "228.00",
        descricao: "",
        identificador: "ml018",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/lupo/lupo18.jpg",
        imagem1: "produtos/lupo/lupo18,1.jpg",
        nome: "Camisa Basica Masculina Lupo",
        preco: "52.00",
        preco_cartao: "56.00",
        descricao: "",
        identificador: "ml019",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo19.jpg",
        imagem1: "produtos/lupo/lupo19,1.jpg",
        nome: "Camisa Basica Masculina Lupo",
        preco: "86.00",
        preco_cartao: "90.00",
        descricao: "",
        identificador: "ml020",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo20.jpg",
        imagem1: "produtos/lupo/lupo20,1.jpg",
        nome: "Camisa Basica Feminina Lupo",
        preco: "86.00",
        preco_cartao: "90.00",
        descricao: "",
        identificador: "ml021",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo21.jpg",
        imagem1: "produtos/lupo/lupo21,1.jpg",
        nome: "Short Intimo Lupo",
        preco: "38.00",
        preco_cartao: "42.00",
        descricao: "",
        identificador: "ml022",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo22.jpg",
        imagem1: "produtos/lupo/lupo22,1.jpg",
        nome: "Short Lupo Cinta, Modelador Cintura Alta Bermuda Lupo",
        preco: "66.00",
        preco_cartao: "74.00",
        descricao: "AF Up-Line Empina Bumbum Loba",
        identificador: "ml023",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/lupo/lupo23.jpg",
        imagem1: "produtos/lupo/lupo23,1.jpg",
        nome: "Bermuda Masculina Lupo",
        preco: "93.00",
        preco_cartao: "103.00",
        descricao: "",
        identificador: "ml024",
        tamanho: "P/M/G",
    }
    ,
    {
        imagem: "produtos/lupo/lupo24.jpg",
        imagem1: "produtos/lupo/lupo24,1.jpg",
        nome: "Bermuda Basica Lupo",
        preco: "73.00",
        preco_cartao: "81.00",
        descricao: "",
        identificador: "ml025",
        tamanho: "P/M/G",
    }
    ,
    {
        imagem: "produtos/lupo/lupo25.jpg",
        imagem1: "produtos/lupo/lupo25,1.jpg",
        nome: "Cueca Slipe Lupo",
        preco: "31.00",
        preco_cartao: "35.00",
        descricao: "",
        identificador: "ml026",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo26.jpg",
        imagem1: "produtos/lupo/lupo26,1.jpg",
        nome: "Cueca Boxer Lupo",
        preco: "32.00",
        preco_cartao: "34.00",
        descricao: "",
        identificador: "ml027",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo27.jpg",
        imagem1: "produtos/lupo/lupo27,1.jpg",
        imagem2: "produtos/lupo/lupo27,2.jpg",
        imagem3: "produtos/lupo/lupo27,3.jpg",
        nome: "Cueca Boxer Infantil Lupo",
        preco: "24.00",
        preco_cartao: "27.00",
        descricao: "",
        identificador: "ml028",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo28.jpg",
        imagem1: "produtos/lupo/lupo28,1.jpg",
        imagem2: "produtos/lupo/lupo28,2.jpg",
        nome: "Calcinha Lupo",
        preco: "29.00",
        preco_cartao: "32.00",
        descricao: "",
        identificador: "ml029",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo28.jpg",
        imagem1: "produtos/lupo/lupo28,1.jpg",
        imagem2: "produtos/lupo/lupo28,2.jpg",
        nome: "Calcinha Lupo",
        preco: "29.00",
        preco_cartao: "32.00",
        descricao: "",
        identificador: "ml029",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo29.jpg",
        imagem1: "produtos/lupo/lupo29,1.jpg",
        nome: "Calcinha Lupo",
        preco: "29.00",
        preco_cartao: "32.00",
        descricao: "",
        identificador: "ml030",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo30.jpg",
        imagem1: "produtos/lupo/lupo30,1.jpg",
        imagem2: "produtos/lupo/lupo30,2.jpg",
        nome: "Calcinha Lupo",
        preco: "29.00",
        preco_cartao: "32.00",
        descricao: "",
        identificador: "ml031",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo31.jpg",
        imagem1: "produtos/lupo/lupo31,1.jpg",
        nome: "Calcinha Boxer Lupo",
        preco: "30.00",
        preco_cartao: "33.00",
        descricao: "",
        identificador: "ml032",
        tamanho: "P/M/G/GG",
    }
    ,
    {
        imagem: "produtos/lupo/lupo32.jpg",
        imagem1: "produtos/lupo/lupo32,1.jpg",
        nome: "Top Basico Lupo",
        preco: "34.00",
        preco_cartao: "37.50",
        descricao: "",
        identificador: "ml033",
        tamanho: "P/M/G/GG",
    }
];
const modaGestante = [
    {
        imagem: "produtos/gestante/gestante0.jpg",
        imagem1: "produtos/gestante/gestante0,1.jpg",
        nome: "Baby Doll Amamentação",
        preco: "60.00",
        preco_cartao: "66.00",
        descricao: "",
        identificador: "mg001",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/gestante/gestante1.jpg",
        imagem1: "produtos/gestante/gestante1,1.jpg",
        imagem2: "produtos/gestante/gestante1,2.jpg",
        nome: "Camisola Amamentação",
        preco: "60.00",
        preco_cartao: "66.00",
        descricao: "",
        identificador: "mg002",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/gestante/gestante2.jpg",
        imagem1: "produtos/gestante/gestante2,1.jpg",
        imagem2: "produtos/gestante/gestante2,2.jpg",
        nome: "Sutiã Amamentação",
        preco: "25.00",
        preco_cartao: "28.00",
        descricao: "",
        identificador: "mg003",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/gestante/gestante3.jpg",
        nome: "Calça Lupo Para Gestante",
        preco: "117.00",
        preco_cartao: "128.00",
        descricao: "",
        identificador: "mg004",
        tamanho: "P/M/G/GG",
    } 
]
const modaTrifil = [
    {
        imagem: "produtos/trifil/trifil0.jpg",
        imagem1: "produtos/trifil/trifil0,1.jpg",
        nome: "Short feminino TriFil",
        preco: "40.00",
        preco_cartao: "45.00",
        descricao: "",
        identificador: "mT001",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil1.jpg",
        imagem1: "produtos/trifil/trifil1,1.jpg",
        imagem2: "produtos/trifil/trifil1,2.jpg",
        imagem3: "produtos/trifil/trifil1,3.jpg",
        nome: "Short feminino TriFil",
        preco: "34.00",
        preco_cartao: "38.00",
        descricao: "",
        identificador: "mT002",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil2.jpg",
        imagem1: "produtos/trifil/trifil2,1.jpg",
        nome: "Short feminino TriFil",
        preco: "50.00",
        preco_cartao: "53.00",
        descricao: "",
        identificador: "mT003",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil3.jpg",
        imagem1: "produtos/trifil/trifil3,1.jpg",
        nome: "Short feminino TriFil",
        preco: "45.00",
        preco_cartao: "50.00",
        descricao: "",
        identificador: "mT004",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil4.jpg",
        imagem1: "produtos/trifil/trifil4,1.jpg",
        imagem2: "produtos/trifil/trifil4,2.jpg",
        nome: "Top Faixa TriFil",
        preco: "18.00",
        preco_cartao: "20.00",
        descricao: "",
        identificador: "mT005",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil5.jpg",
        imagem1: "produtos/trifil/trifil5,1.jpg",
        nome: "Top Basico TriFil",
        preco: "24.00",
        preco_cartao: "27.00",
        descricao: "",
        identificador: "mT006",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil6.jpg",
        imagem1: "produtos/trifil/trifil6,1.jpg",
        nome: "Short Cinta TriFil",
        preco: "38.00",
        preco_cartao: "42.00",
        descricao: "",
        identificador: "mT007",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil7.jpg",
        imagem1: "produtos/trifil/trifil7,2.jpg",
        nome: "Short modelador TriFil",
        preco: "34.00",
        preco_cartao: "36.00",
        descricao: "",
        identificador: "mT008",
        tamanho: "P/M/G/GG",
    },
    {
        imagem: "produtos/trifil/trifil8.jpg",
        imagem1: "produtos/trifil/trifil8,1.jpg",
        nome: "Calça Leg TriFil",
        preco: "45.00",
        preco_cartao: "50.00",
        descricao: "",
        identificador: "mT009",
        tamanho: "P/M/G",
    },
    {
        imagem: "produtos/trifil/trifil9.jpg",
        imagem1: "produtos/trifil/trifil9,1.jpg",
        nome: "Meia TriFil",
        preco: "8.50",
        preco_cartao: "9.00",
        descricao: "Par",
        identificador: "mT010",
        tamanho: "unico",
    },
]
function toggleCategorias() {
    const categorias = document.getElementById('categorias');
    if (categorias.style.display === 'none' || categorias.style.display === '') {
        categorias.style.display = 'flex';
    } else {
        categorias.style.display = 'none';
    }
}

const seccaoDetalhes = document.querySelector(".seccao_especifica");

// Produtos
function renderizarProdutos(categoriaId, produtos) {
    const secao = document.querySelector(`#${categoriaId}`);
    const container = secao.querySelector(".produtos");

    if (container.children.length > 0) return;

    container.innerHTML = "";

    const containerGeral = secao.querySelector(".container");

    produtos.forEach(prod => {
        const divProduto = criarElementoProduto(prod);
        divProduto.addEventListener("click", () => exibirDetalhesProduto(prod, containerGeral));
        container.appendChild(divProduto);
    });
}

function criarElementoProduto(prod) {
    const divProduto = document.createElement("div");
    divProduto.classList.add("produto");

    divProduto.innerHTML = `
        <img class="imagem" src="${prod.imagem}" alt="${prod.nome}">
        <h3 class="nome_produto">${prod.nome}</h3>
        <button class="preco">R$ ${prod.preco}</button>
        <p class="descricao">${prod.descricao}</p>
    `;

    return divProduto;
}

function exibirDetalhesProduto(prod, containerGeral) {
    const elementos = [
        "header",
        "nav",
        ".botoes-laterais",
        ".redes-sociais",
        ".banner",
        "#moda-lupo",
        "#moda-gestante",
        "#moda-trifil",
        ".redes-sociais-responsive",
        ".banner-responsive",
        ".bottons",
        ".inicio"

    ];

    // 🔻 Esconder
    elementos.forEach(sel => {
        document.querySelectorAll(sel).forEach(el => {
            el.dataset.display = el.style.display; // Salva o estado atual
            el.style.display = "none";
        });
    });
    seccaoDetalhes.style.display = "grid";

    const imagensExtras = [prod.imagem];
    for (let i = 1; i <= 8; i++) {
        const key = `imagem${i}`;
        if (prod[key]) imagensExtras.push(prod[key]);
    }

    seccaoDetalhes.innerHTML = gerarHTMLDetalhes(prod, imagensExtras);
    configurarEventosDetalhes(prod, containerGeral);
}

function gerarHTMLDetalhes(prod, imagens) {
    const tamanhos = prod.tamanho ? prod.tamanho.split('/').filter(t => t) : [];
    let opcoesTamanhoHTML = `<option value="">Selecione</option>`;

    tamanhos.forEach(tamanho => {
        opcoesTamanhoHTML += `<option value="${tamanho}">${tamanho}</option>`;
    });

    // Se existir tamanhoextra, adiciona uma opção extra
    if (prod.tamanhoextra) {
        // Para valor do option, guardar só o texto mesmo
        opcoesTamanhoHTML += `<option value="${prod.tamanhoextra}">${prod.tamanhoextra}</option>`;
    }
    return `
        <div class="detalhes-produto">
            <div class="titulo-detalhe">
                <h3>${prod.nome}</h3>
                <button class="fechar-detalhes"><i class="bi bi-x-circle"></i></button>
            </div>
             <div class="detalhes">
            <div class="alinhar">
                <img class="principal" src="${prod.imagem}" alt="${prod.nome}">
                <div class="galeria">
                    ${imagens.map(src => `<img src="${src}" alt="${prod.nome}">`).join("")}
                </div>
            </div>    
                <div class="informacoes">
                    <p><strong>Preço à vista:</strong> R$ ${prod.preco}</p>
                    <p><strong>Preço no cartão:</strong> R$ ${prod.preco_cartao}</p>
                    <p><strong>Descrição: </strong>${prod.descricao}</p>
                    <div class="tamanho-select">
                        <label for="tamanho"><strong>Tamanho:</strong></label>
                        <select id="tamanho" class="selecionar-tamanho">
                            ${opcoesTamanhoHTML}
                        </select>
                    </div>
                    <button class="adicionar-carrinho">Adicionar ao Carrinho</button>
                </div>
            </div>
        </div>
    `;
}
// Fim produtos

// sessao especifica
function configurarEventosDetalhes(prod, containerGeral) {
    const imgPrincipal = seccaoDetalhes.querySelector(".principal");
    const selectTamanho = seccaoDetalhes.querySelector(".selecionar-tamanho");
    const precoVistaSpan = seccaoDetalhes.querySelector("#preco-vista");
    const subtotalSpan = seccaoDetalhes.querySelector("#subtotal");

    seccaoDetalhes.querySelectorAll(".galeria img").forEach(mini => {
        mini.addEventListener("click", () => {
            imgPrincipal.src = mini.src;
        });
    });

    seccaoDetalhes.querySelector(".fechar-detalhes").addEventListener("click", () => {
        seccaoDetalhes.style.display = "none";
        containerGeral.style.display = "grid";

        if (window.matchMedia("(max-width: 576px)").matches) {
            // Para celulares
            document.querySelector("header").style.display = "block";
            document.querySelector(".banner-tela-inicial").style.display = "flex";
            document.querySelector(".banner").style.display = "none";
            document.querySelector(".redes-sociais").style.display = "none";
            document.querySelector(".botoes-laterais").style.display = "none";
            location.reload();
            document.querySelectorAll("section").forEach(section => {
                section.style.display = "none";
            });
        } else {
            // Para telas maiores
            document.querySelector("header").style.display = "block";
            document.querySelector("nav").style.display = "block";
            document.querySelector(".banner").style.display = "block";
            document.querySelector(".redes-sociais").style.display = "flex";
            document.querySelector(".botoes-laterais").style.display = "flex";

            document.querySelectorAll("section").forEach(section => {
                section.style.display = "grid";
            });
        }
        resetarLayoutProdutos();
    });

    // Atualiza preço quando muda tamanho
    selectTamanho.addEventListener("change", () => {
        const selecionado = selectTamanho.value;
        let precoAtual = parseFloat(prod.preco);

        if (selecionado === prod.tamanhoextra) {
            precoAtual = parseFloat(prod.precoextra);
        }

        precoVistaSpan.textContent = precoAtual.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        subtotalSpan.textContent = precoAtual.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    });

    seccaoDetalhes.querySelector(".adicionar-carrinho").addEventListener("click", () => {
        const tamanhoSelecionado = selectTamanho.value;

        if (!tamanhoSelecionado) {
            mostrarAlertaCustomizado("Por favor, selecione um tamanho!");
            return;
        }


        const precoSelecionado = tamanhoSelecionado === prod.tamanhoextra && prod.precoextra ? prod.precoextra : prod.preco;

        const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

        const produtoCarrinho = {
            identificador: `${prod.identificador}_${tamanhoSelecionado}`,
            nome: prod.nome,
            preco: precoSelecionado, // Use o preço correto aqui
            preco_cartao: prod.preco_cartao,
            imagem: prod.imagem,
            descricao: prod.descricao,
            categoria: prod.categoria,
            tamanho: tamanhoSelecionado,
            quantidade: 1
        };

        carrinho.push(produtoCarrinho);
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        mostrarAlertaCustomizado("Produto adicionado ao carrinho!");
    });
}

function resetarLayoutProdutos() {
    document.querySelectorAll("section .produtos").forEach(container => {
        container.style.removeProperty("display");
        container.style.transition = "all 0.3s ease";
    });


    document.querySelectorAll("section").forEach(secao => {
        secao.style.display = "";
    });
}

// Fim Sessao especifica

// Carrinho
document.getElementById("carrinho").addEventListener("click", () => {
    const usuario = JSON.parse(localStorage.getItem("usuarioLogado"));

    if (!usuario) {
        alert("Você precisa fazer login antes de acessar o carrinho.");
        return;
    }
    carregarCarrinho();
    console.log(JSON.parse(localStorage.getItem("carrinho")));
    document.getElementById("sessao-carrinho").style.display = "flex";
    document.getElementById("sessao-frete").style.display = "none";
    seccaoDetalhes.style.display = "none";
    // Garante que o header apareça
    document.querySelector("header").style.display = "flex";

    const esconder = [
        "header",
        "nav",
        ".botoes-laterais",
        ".redes-sociais",
        ".banner",
        "#moda-lupo",
        "#moda-gestante",
        "#moda-trifil",
        ".banner-responsive",
        ".bottons",
        ".inicio",
        ".redes-sociais-responsive"

    ];
    esconder.forEach(sel => {
        document.querySelectorAll(sel).forEach(el => el.style.display = "none");
    });
});

function fecharCarrinho() {
    const resetar = [
        { selector: "header", display: "flex" },
        { selector: "nav", display: "flex" },
        { selector: ".botoes-laterais", display: "flex" },
        { selector: ".redes-sociais", display: "flex" },
        { selector: ".banner", display: "grid" },
        { selector: "#sessao-frete", display: "block" },
        { selector: "#moda-lupo", display: "grid" },
        { selector: "#moda-gestante", display: "grid" },
        { selector: "#moda-trifil", display: "grid" },
    ];
    if (window.matchMedia("(max-width: 576px)").matches) {
        // Para celulares
        document.querySelector("header").style.display = "block";
        document.querySelector(".banner-tela-inicial").style.display = "flex";
        document.querySelector(".banner").style.display = "none";
        document.querySelector(".redes-sociais").style.display = "none";
        document.querySelector(".botoes-laterais").style.display = "none";
        location.reload();
        document.querySelectorAll("section").forEach(section => {
            section.style.display = "none";
        });
    } else {

        resetar.forEach(item => {
            document.querySelectorAll(item.selector).forEach(el => {
                el.style.display = item.display; // Define o display específico
            });
        });

        // Ocultar a seção do carrinho
        document.getElementById("sessao-carrinho").style.display = "none";
    }
}

function carregarCarrinho() {
    const container = document.getElementById("lista-carrinho");
    container.innerHTML = "";

    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    carrinho.forEach((prod, index) => container.appendChild(criarItemCarrinho(prod, index, carrinho)));

    atualizarResumoCompra(carrinho);
}
function calcularFretePorBairro(bairro) {
    const bairrosFrete10 = ["Alemanha", "Alto do Angelim", "Alto do Calhau", "Alto do Pinho", "Alto Turú", "Anil", "Angelim", "Apeadouro", "Aroeiras", "Areinha", "Aurora", "Bairro de Fátima", "Barramar", "Barreto", "Belira", "Bequimão", "Calhau", "Camboa", "Cantinho do Céu", "Caratatiua", "Centro", "Chácara Brasil", "Codozinho", "Cohab", "Cohafuma", "Cohajap", "Cohama", "Cohapam", "Cohaserma", "Cohatrac", "Coheb", "Coreia de Baixo", "Coreia de Cima", "Coroado", "Cruzeiro do Anil", "Cutim Anil", "Diamante", "Divinéia", "Fabril", "Fé em Deus", "Filipinho", "Forquilha", "Grand Park", "Ilhinha", "Ipase de Baixo", "Ipase de Cima", "Ipem Turú", "Itapiracó", "Ivar Saldanha", "Jaracaty", "Jardim Alvorada", "Jardim das Margaridas", "Jardim Eldorado", "Jardim Turu", "João de Deus", "João Paulo", "Jordoa", "Liberdade", "Lira", "Macaúba", "Madre Deus", "Maiobinha", "Maranhão Novo", "Monte Castelo", "Novo Angelim", "Olho d'Água", "Outeiro da Cruz", "Pão de Açúcar", "Parque Amazonas", "Parque Athenas", "Parque Atlântico", "Parque dos Sabiás", "Parque shalom", "Parque Universitário", "Parque Vitória", "Península", "Pirapora", "Planalto Anil", "Planalto Pingão", "Ponta d'Areia", "Ponta do Farol", "Quintas do Calhau", "Quitandinha", "Recanto Fialho", "Recanto Turú", "Recanto Vinhais", "Redenção", "Renascença", "Residencial Araras", "Residencial São Domingos", "Rio Anil", "Sacavém", "Salina do Sacavém", "Santa Cruz", "Santa Rosa", "Santo Antônio", "São Bernardo", "São Cristóvão", "São Francisco", "Saramanta", "Solar dos Lusitanos", "Sol e Mar", "Terra Livre", "Tirirical", "Túnel do Sacavém", "Vera Cruz", "Vila 7 de Setembro", "Vila Bessa", "Vila Brasil", "Vila Conceição (Alto do Calhau)", "Vila Cruzado", "Vila Isabel Cafeteira (Cohab)", "Vila Lobão", "Vila Luizão", "Vila Palmeira", "Vila Passos", "Vila Vicente Fialho", "Vinhais"];

    const bairrosFrete15 = ["Santa Efigênia", "Jardim América", "Cidade Operária", "Coroadinho", "Recanto dos Nobres", "Parque dos nobres", "Parque timbiras", "Parque Pindorama", "Nice Lobão", "Bom Jesus"];

    const bairrosFrete20 = ["Alonso Costa", "Alphaville", "Alto da Esperança", "Alto do Farol", "Alto Jaguarema", "Amendoeira", "Anjo da Guarda", "Apaco", "Araçagy", "Alto Itapiraco", "Bacanga", "Bom Jardim", "Cidade Olímpica", "Distrito Industrial", "Fumacê", "Gancharia", "Gapara", "Geniparana", "Janaina", "Jardim Tropical", "Lima Verde", "Labelle Park", "Magril", "Maiobão", "Maracanã", "Mauro Fecury", "Miritiua", "Paranã", "Parque Jair", "Piancó", "Pontal da Ilha", "Residencial Paraíso", "Residencial Tiradentes", "Ribeira", "Riod", "Sá Viana", "Santa Barbara", "Santa Clara", "São Raimundo", "Tibiri", "Vila Ariri", "Vila Cascavel", "Vila Embratel", "Vila Esperança", "Vila Funil", "Vila Isabel", "Vila Itamar", "Vila Nova", "Vila Nova República", "Vila Sarney", "Vila São Luís", "Vila Vitória"];

    bairro = bairro.trim();

    if (bairrosFrete10.includes(bairro)) {
        return 10;
    } else if (bairrosFrete15.includes(bairro)) {
        return 15;
    } else if (bairrosFrete20.includes(bairro)) {
        return 20;
    } else {
        return 0; // valor padrão para bairros não listados
    }
}

function criarItemCarrinho(prod, index, carrinho) {
    const item = document.createElement("div");
    item.classList.add("item-carrinho");

    const precoUnitario = parseFloat(prod.preco); // Use prod.preco aqui
    const precocartao = parseFloat(prod.preco_cartao);
    const subtotal = precoUnitario * prod.quantidade;

    item.innerHTML = `
    <img src="${prod.imagem}" alt="${prod.nome}" class="imagem-carrinho">  
    <div>
        <h3>${prod.nome}</h3>
        <p><strong>Preço no pix:</strong> R$ ${precoUnitario.toFixed(2)}</p>
        <p><strong>Preço no cartão:</strong> R$ ${precocartao.toFixed(2)}</p>
        <p><strong>Tamanho:</strong> ${prod.tamanho}</p>
    </div>
    <div class="controle-quantidade">
        <button class="btn-menos">-</button>
        <span class="quantidade">${prod.quantidade}</span>
        <button class="btn-mais">+</button>
    </div>
`;

    // Adiciona eventos para controle de quantidade
    item.querySelector(".btn-menos").addEventListener("click", () => {
        if (prod.quantidade > 1) {
            carrinho[index].quantidade--;
        } else {
            carrinho.splice(index, 1);
        }
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        carregarCarrinho();
    });

    item.querySelector(".btn-mais").addEventListener("click", () => {
        carrinho[index].quantidade++;
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        carregarCarrinho();
    });

    return item;
}

function criarResumoCompra() {
    let containerResumo = document.getElementById("container-resumo");
    if (!containerResumo) {
        containerResumo = document.createElement("div");
        containerResumo.id = "container-resumo";
        document.getElementById("sessao-carrinho").appendChild(containerResumo);
    }

    let sessaoFrete = document.getElementById("sessao-frete");
    if (!sessaoFrete) {
        sessaoFrete = document.createElement("section");
        sessaoFrete.id = "sessao-frete";
        sessaoFrete.innerHTML = `
        <h2 class="titulo-endereco">Endereço de Entrega</h2>
        
                <div class="campo-endereco">
                    <label for="cep"> CEP:<span style="color: red;">*</span></label>
                    <input type="text" id="cep" maxlength="9" placeholder="65000-000" class="input-endereco" required>
                </div>

                <div class="campo-endereco">
                    <label for="rua">Rua:</label>
                    <input type="text" id="rua" readonly class="input-endereco">
                </div>

                <div class="campo-endereco">
                    <label for="bairro">Bairro:</label>
                    <input type="text" id="bairro" readonly class="input-endereco">
                    </div>
                    
                <div class="campo-endereco">
                    <label for="numero"> Número:<span style="color: red;">*</span></label>
                    <input type="text" id="numero" class="input-endereco" required>
                </div>

                <div class="campo-endereco">
                    <label for="complemento"> Complemento:<span style="color: red;">*</span></label>
                    <input type="text" id="complemento" class="input-endereco" required>
                </div>
                <h3 class="info">* O valor do frete será pago no ato da entrega</h3>
                <button class="fechar-frete">confirmar</i></button>
            `;
        containerResumo.appendChild(sessaoFrete);
        const botaoFechar = sessaoFrete.querySelector(".fechar-frete");

        botaoFechar.addEventListener("click", () => {
            const cep = document.getElementById("cep").value.trim();
            const rua = document.getElementById("rua").value.trim();
            const bairro = document.getElementById("bairro").value.trim();
            const numero = document.getElementById("numero").value.trim();

            // Verifica se todos os campos obrigatórios estão preenchidos
            if (cep && rua && bairro && numero) {
                botaoContinuarCompra.disabled = false; // Habilita o botão
                sessaoFrete.style.display = "none";
                document.body.style.overflow = "";

                // Mostrar novamente o conteúdo do carrinho e o resumo
                const conteudoCarrinho = document.getElementById("conteudo-carrinho");
                const resumo = document.getElementById("resumo-compra");

                if (conteudoCarrinho) conteudoCarrinho.style.display = "block";
                if (resumo) resumo.style.display = "block";
            } else {
                alert("Preencha todos os campos obrigatórios do endereço!");
            }
        });



        // ViaCEP lógica
        const cepInput = document.getElementById("cep");
        const ruaInput = document.getElementById("rua");
        const bairroInput = document.getElementById("bairro");

        cepInput.addEventListener("blur", () => {
            const cep = cepInput.value.replace(/\D/g, "");
            if (cep.length === 8) {
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(res => res.json())
                    .then(data => {
                        if (!data.erro) {
                            ruaInput.value = data.logradouro;
                            bairroInput.value = data.bairro;
                            carregarCarrinho(); // Atualiza o resumo quando o bairro mudar
                        } else {
                            alert("CEP não encontrado.");
                            ruaInput.value = "";
                            bairroInput.value = "";
                            carregarCarrinho();
                        }
                    })
                    .catch(() => {
                        alert("Erro ao buscar o CEP.");
                    });
            } else {
                ruaInput.value = "";
                bairroInput.value = "";
                carregarCarrinho();
            }
        });

        // Atualiza o resumo ao mudar o bairro manualmente (caso permita edição)
        bairroInput.addEventListener("input", () => {
            carregarCarrinho();
        });
    }

    let resumo = document.getElementById("resumo-compra");
    if (!resumo) {
        resumo = document.createElement("div");
        resumo.id = "resumo-compra";
        resumo.innerHTML = `
                <h2>Resumo da compra</h2>
                <div class="linha linhaProdutos">
                    <span class="titulo">Produtos (0):</span>
                    <span class="valor" id="total-produtos">0,00</span>
                </div>
                <div class="linha fretes">
                    <span class="titulo">Frete:</span>
                    <span class="valor" id="valor-frete">R$ 0,00</span>
                    <button id="botao-escolher-endereco">escolha seu endereço</button>
                </div>
                <div class="linha total">
                    <span class="titulo">Total:</span>
                    <span class="valor" id="valor-total">a decidir</span>
                </div>
                <div id="selecionar-pagamento">
                <h3>Selecione o meio de pagamento:</h3>
                <label><input type="radio" name="meioPagamento" value="pix" checked> Pix</label>
                <label><input type="radio" name="meioPagamento" value="cartao"> Cartão</label>
            </div>
                <button id="botao-continuar-compra">Continuar a compra</button>
            `;
        containerResumo.appendChild(resumo);
    }

    const botaoMostrarFrete = document.getElementById("botao-escolher-endereco");
    const conteudoCarrinho = document.getElementById("conteudo-carrinho");

    if (botaoMostrarFrete) {
        botaoMostrarFrete.addEventListener("click", () => {

            if (sessaoFrete) {
                sessaoFrete.style.display = "flex";
            }
            if (conteudoCarrinho) {
                conteudoCarrinho.style.display = "none";
            }
            if (resumo) {
                resumo.style.display = "none";
            }
        });
    }
    botaoMostrarFrete.addEventListener("click", () => {
        const botaoEndereco = document.getElementById("botao-escolher-endereco");

        if (botaoEndereco) {
            // Altera o texto do botão
            botaoEndereco.textContent = "PAGUE NA ENTREGA";


            // Desativa o botão (opcional)
            botaoEndereco.disabled = true;
        }
    })

    const token = '7900323987:AAFpptfwg0xFZSOdjRIxT_Y0rjCC7xHzMgU'; // substitua pelo token do seu bot
    const chatIdGrupo = -1002539224248;
    const botaoContinuarCompra = document.getElementById("botao-continuar-compra");
    document.getElementById("botao-continuar-compra").disabled = true;

    if (botaoContinuarCompra) {
        botaoContinuarCompra.addEventListener('click',  () => {
            botaoContinuarCompra.disabled = false; // Habilita o botão
            console.log('Botão continuar clicado');

            const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
            if (carrinho.length === 0) {
                alert("Seu carrinho está vazio!");
                return;
            }

            // Dados do endereço (se preenchidos)
            const rua = document.getElementById("rua")?.value || "";
            const bairro = document.getElementById("bairro")?.value || "";
            const numero = document.getElementById("numero")?.value || "";
            const complemento = document.getElementById("complemento")?.value || "";

            // Dados do usuário logado
            const usuario = JSON.parse(localStorage.getItem('usuarioLogado'));
            const primeiroNome = usuario ? usuario.nome.split(' ')[0] : 'Cliente';
            const telefone = usuario?.telefone || 'Não informado';


            // Calcula total
            const totalProdutos = carrinho.reduce((acc, p) => acc + (p.preco * p.quantidade), 0);

            // Função de frete — implemente conforme sua lógica
            function calcularFretePorBairro(bairro) {
                const bairrosFrete10 = ["Alemanha", "Alto do Angelim", "Alto do Calhau", "Alto do Pinho", "Alto Turú", "Anil", "Angelim", "Apeadouro", "Aroeiras", "Areinha", "Aurora", "Bairro de Fátima", "Barramar", "Barreto", "Belira", "Bequimão", "Calhau", "Camboa", "Cantinho do Céu", "Caratatiua", "Centro", "Chácara Brasil", "Codozinho", "Cohab", "Cohafuma", "Cohajap", "Cohama", "Cohapam", "Cohaserma", "Cohatrac", "Coheb", "Coreia de Baixo", "Coreia de Cima", "Coroado", "Cruzeiro do Anil", "Cutim Anil", "Diamante", "Divinéia", "Fabril", "Fé em Deus", "Filipinho", "Forquilha", "Grand Park", "Ilhinha", "Ipase de Baixo", "Ipase de Cima", "Ipem Turú", "Itapiracó", "Ivar Saldanha", "Jaracaty", "Jardim Alvorada", "Jardim das Margaridas", "Jardim Eldorado", "Jardim Turu", "João de Deus", "João Paulo", "Jordoa", "Liberdade", "Lira", "Macaúba", "Madre Deus", "Maiobinha", "Maranhão Novo", "Monte Castelo", "Novo Angelim", "Olho d'Água", "Outeiro da Cruz", "Pão de Açúcar", "Parque Amazonas", "Parque Athenas", "Parque Atlântico", "Parque dos Sabiás", "Parque shalom", "Parque Universitário", "Parque Vitória", "Península", "Pirapora", "Planalto Anil", "Planalto Pingão", "Ponta d'Areia", "Ponta do Farol", "Quintas do Calhau", "Quitandinha", "Recanto Fialho", "Recanto Turú", "Recanto Vinhais", "Redenção", "Renascença", "Residencial Araras", "Residencial São Domingos", "Rio Anil", "Sacavém", "Salina do Sacavém", "Santa Cruz", "Santa Rosa", "Santo Antônio", "São Bernardo", "São Cristóvão", "São Francisco", "Saramanta", "Solar dos Lusitanos", "Sol e Mar", "Terra Livre", "Tirirical", "Túnel do Sacavém", "Vera Cruz", "Vila 7 de Setembro", "Vila Bessa", "Vila Brasil", "Vila Conceição (Alto do Calhau)", "Vila Cruzado", "Vila Isabel Cafeteira (Cohab)", "Vila Lobão", "Vila Luizão", "Vila Palmeira", "Vila Passos", "Vila Vicente Fialho", "Vinhais"];

                const bairrosFrete15 = ["Santa Efigênia", "Jardim América", "Cidade Operária", "Coroadinho", "Recanto dos Nobres", "Parque dos nobres", "Parque timbiras", "Parque Pindorama", "Nice Lobão", "Bom Jesus"];

                const bairrosFrete20 = ["Alonso Costa", "Alphaville", "Alto da Esperança", "Alto do Farol", "Alto Jaguarema", "Amendoeira", "Anjo da Guarda", "Apaco", "Araçagy", "Alto Itapiraco", "Bacanga", "Bom Jardim", "Cidade Olímpica", "Distrito Industrial", "Fumacê", "Gancharia", "Gapara", "Geniparana", "Janaina", "Jardim Tropical", "Lima Verde", "Labelle Park", "Magril", "Maiobão", "Maracanã", "Mauro Fecury", "Miritiua", "Paranã", "Parque Jair", "Piancó", "Pontal da Ilha", "Residencial Paraíso", "Residencial Tiradentes", "Ribeira", "Riod", "Sá Viana", "Santa Barbara", "Santa Clara", "São Raimundo", "Tibiri", "Vila Ariri", "Vila Cascavel", "Vila Embratel", "Vila Esperança", "Vila Funil", "Vila Isabel", "Vila Itamar", "Vila Nova", "Vila Nova República", "Vila Sarney", "Vila São Luís", "Vila Vitória"];

                bairro = bairro.trim();

                if (bairrosFrete10.includes(bairro)) {
                    return 10;
                } else if (bairrosFrete15.includes(bairro)) {
                    return 15;
                } else if (bairrosFrete20.includes(bairro)) {
                    return 20;
                } else {
                    return 25; // valor padrão para bairros não listados
                }
            }

            const frete = calcularFretePorBairro(bairro);
            const totalGeral = totalProdutos;

            const meioPagamentoSelecionado = document.querySelector('input[name="meioPagamento"]:checked')?.value || 'pix';

            // Calcula quantidade de produtos
            const quantidadeProdutos = carrinho.reduce((acc, prod) => acc + prod.quantidade, 0);

            // Calcula total dos produtos com base no meio de pagamento
            const produtosAtualizados = carrinho.reduce((acc, prod) => {
                const preco = meioPagamentoSelecionado === "cartao" ? parseFloat(prod.preco_cartao) : parseFloat(prod.preco);
                return acc + (preco * prod.quantidade);
            }, 0);

            // Monta mensagem dos produtos
            let mensagemProdutos = carrinho.map((prod, i) =>
                `${i + 1}. ${prod.nome} - Tamanho: ${prod.tamanho} - Quantidade: ${prod.quantidade} - R$ ${(prod.preco * prod.quantidade).toFixed(2)}`
            ).join("\n");

            // Monta mensagem final para o Telegram
            let mensagem = `Pedido de ${primeiroNome}:\n` +
                `Telefone: ${telefone}\n\n` +
                `${mensagemProdutos}\n\n` +
                `Subtotal: R$ ${produtosAtualizados.toFixed(2)}\n` +
                `Frete: R$ ${frete.toFixed(2)}\n` +
                `Total: R$ ${totalGeral.toFixed(2)}\n\n` +
                `Endereço para entrega:\nRua: ${rua}\nBairro: ${bairro}\nNúmero: ${numero}\nComplemento: ${complemento}\n\n` +
                `ESPERANDO CONFIRMAÇÃO DE PAGAMENTO`;

            // Adicionando logs para verificar os dados
            console.log("Dados do Pedido:");
            console.log("Nome:", primeiroNome);
            console.log("Telefone:", telefone);
            console.log("Produtos:", mensagemProdutos);
            console.log("Subtotal:", produtosAtualizados);
            console.log("Frete:", frete);
            console.log("Total:", totalGeral);
            console.log("Endereço:", {
                rua: rua,
                bairro: bairro,
                numero: numero,
                complemento: complemento
            });

            const totalAtualizado = produtosAtualizados;

            function pagarConta() {
                const dadosPedido = {
                    nome: primeiroNome,
                    telefone: telefone,
                    produtos: mensagemProdutos,
                    subtotal: produtosAtualizados,
                    frete: frete,
                    total: totalAtualizado,
                    endereco: {
                        rua: rua,
                        bairro: bairro,
                        numero: numero,
                        complemento: complemento
                    }
                };

                // Logando os dados que serão enviados
                console.log("Dados do Pedido para o Backend:", dadosPedido);

                fetch('https://api-lojao.onrender.com/pagar', {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(dadosPedido)
                })
                    .then(res => {
                        console.log("Resposta do servidor:", res);
                        return res.json();
                    })
                    .then(data => {
                        console.log("Dados retornados do servidor:", data);
                        window.location.href = data.init_point;  // Redireciona para o checkout do Mercado Pago
                    })
                    .catch(error => {
                        console.error("Erro ao enviar a requisição:", error);
                    });


            }
            // Função para enviar mensagem para Telegram
            let mensagemEnviada = false;

            function enviarMensagemTelegram(chatId, texto) {
                if (mensagemEnviada) {
                    console.log("Mensagem já enviada. Não será enviada novamente.");
                    return; // Se a mensagem já foi enviada, não faz nada
                }

                fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: texto
                    })
                })
                    .then(res => res.json())
                    .then(data => {
                        if (data.ok) {
                            mensagemEnviada = true;
                            console.log("Mensagem enviada com sucesso.");
                        } else {
                            console.error("Erro ao enviar mensagem:", data);
                        }
                    })
                    .catch(err => {
                        console.error("Erro na requisição:", err);
                    });
            }

            // Envia para o grupo da loja
            pagarConta();
            enviarMensagemTelegram(chatIdGrupo, mensagem);
            alert("Você será redirecionado \n aguarde alguns segundos")
            document.getElementById("botao-continuar-compra").disabled = true;
        });
    }
    return resumo;

}{ once: true }

function atualizarResumoCompra(carrinho) {
    const resumo = criarResumoCompra();
    const formatarValor = valor => valor.toFixed(2).replace(".", ",");
    const meioPagamentoSelecionado = document.querySelector('input[name="meioPagamento"]:checked')?.value || 'pix';

    // Calcula quantidade de produtos
    const quantidadeProdutos = carrinho.reduce((acc, prod) => acc + prod.quantidade, 0);

    // Calcula total dos produtos com base no meio de pagamento
    const totalProdutos = carrinho.reduce((acc, prod) => {
        const preco = meioPagamentoSelecionado === "cartao" ? parseFloat(prod.preco_cartao) : parseFloat(prod.preco);
        return acc + (preco * prod.quantidade);
    }, 0);
    document.querySelectorAll('input[name="meioPagamento"]').forEach((input) => {
        input.addEventListener('change', () => {
            const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
            atualizarResumoCompra(carrinho);
        });
    });


    // Pega o bairro para calcular frete
    const bairroInput = document.getElementById("bairro");
    const bairro = bairroInput ? bairroInput.value : "";
    const frete = calcularFretePorBairro(bairro);

    const totalGeral = totalProdutos;

    resumo.querySelector(".linhaProdutos .titulo").textContent = `Produtos: (${quantidadeProdutos})`;
    resumo.querySelector("#total-produtos").textContent = `R$ ${formatarValor(totalProdutos)}`;
    resumo.querySelector(".fretes .valor").textContent = frete === 0 ? "a decidir" : `R$ ${formatarValor(frete)}`;
    resumo.querySelector(".total .valor").textContent = `R$ ${formatarValor(totalGeral)}`;
}

function carregarCarrinho() {
    const container = document.getElementById("lista-carrinho");
    container.innerHTML = "";

    const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

    if (carrinho.length === 0) {
        container.innerHTML = "<p style='font-size:1.5rem;'>Seu carrinho está vazio 😕</p>";
        atualizarResumoCompra(carrinho);
        return;
    }

    carrinho.forEach((prod, index) => {
        container.appendChild(criarItemCarrinho(prod, index, carrinho));
    });

    atualizarResumoCompra(carrinho);
}

function mostrarsessaofrete() {
    const sessaoFrete = document.getElementById("sessao-frete");
    const carrinho = document.getElementById("conteudo-carrinho");
    const resumo = document.getElementById("resumo-compra");

    if (sessaoFrete && carrinho && resumo) {
        sessaoFrete.style.display = "block";
        carrinho.style.display = "none";
        resumo.style.display = "none";
        document.body.style.overflow = "hidden";
    }
}
// Fim carrinho


function mostrarAlertaCustomizado(texto) {
    const alerta = document.getElementById("alerta-customizado");
    const mensagem = document.getElementById("mensagem-alerta");

    mensagem.textContent = texto || "Produto adicionado ao carrinho!";
    alerta.classList.add("mostrar");

    setTimeout(() => {
        alerta.classList.remove("mostrar");
    }, 3000);
}

const usuario = JSON.parse(localStorage.getItem('usuarioLogado'));

if (usuario) {
    const primeiroNome = usuario.nome.split(' ')[0]; // Pega só o primeiro nome
    document.getElementById('login').innerHTML = `<span>${primeiroNome}</span>`;
    document.getElementById('login').href = 'perfil.html'; // Leva para página de perfil
} else {
    document.getElementById('login').innerHTML = `<span>Login</span>`;
    document.getElementById('login').href = 'login.html';
}

window.addEventListener("DOMContentLoaded", () => {
    renderizarProdutos("moda-lupo", modaLupo);
    renderizarProdutos("moda-gestante", modaGestante);
    renderizarProdutos("moda-trifil", modaTrifil);


    resetarLayoutProdutos();
})